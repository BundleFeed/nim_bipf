/* Generated by Nim Compiler v1.9.3 */
#define NIM_INTBITS 64

#include "nimbase.h"
#include <string.h>
#undef LANGUAGE_C
#undef MIPSEB
#undef MIPSEL
#undef PPC
#undef R3000
#undef R4000
#undef i386
#undef linux
#undef mips
#undef near
#undef far
#undef powerpc
#undef unix
#define nimfr_(x, y)
#define nimln_(x, y)
typedef struct NimStrPayload NimStrPayload;
typedef struct NimStringV2 NimStringV2;
typedef struct tyTuple__7q7q3E6Oj24ZNVJb9aonhAg tyTuple__7q7q3E6Oj24ZNVJb9aonhAg;
struct NimStrPayload {
NI cap;
NIM_CHAR data[SEQ_DECL_SIZE];
};
struct NimStringV2 {
NI len;
NimStrPayload* p;
};
struct tyTuple__7q7q3E6Oj24ZNVJb9aonhAg {
NimStringV2 Field0;
NimStringV2 Field1;
NimStringV2 Field2;
};
static N_INLINE(void, nimZeroMem)(void* p__BuPKoq7dppy2upaj3KUaxw, NI size__ttWVm79bajRU3tarcA7MkLw);
static N_INLINE(void, nimSetMem__systemZmemory_7)(void* a__tZiCJHYy5dYyAh9cxwrrVhQ, int v__iM7JOvZxArJIvbhGyRZG6Q, NI size__ntsFNLS0mpvnjQFrZT7DCw);
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void);
N_LIB_PRIVATE N_NIMCALL(void, eqsink___stdZassertions_36)(NimStringV2* dest__VTJh4gw5Rje9bocjsx81Ekg, NimStringV2 src__GJAw6lOoetbnH4F11f7wrg);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, substr__system_8447)(NimStringV2 s__eXeA1kh9ab7IlWnp9b2LKlnw, NI first__HUA4TUIjnYTo9aHRDiDB4TQ, NI last__1Ew0dzcZj5unitItuDdtPA);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, substr__system_8459)(NimStringV2 s__eXeA1kh9ab7IlWnp9b2LKlnw_2, NI first__HUA4TUIjnYTo9aHRDiDB4TQ_2);
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___stdZassertions_30)(NimStringV2* dest__C2JKGPCNdWKCPrsQvNywTQ);
N_NIMCALL(NimStringV2, rawNewString)(NI cap__aiFqe9bSUp1HPQPsLukio0A);
N_LIB_PRIVATE N_NIMCALL(void, joinPathImpl__stdZprivateZospaths50_49)(NimStringV2* result__Duce9bPtdY9cuV41HJK3P9bJQ, NI* state__RtRLRCJcio8EY23SUmqb0Q, NimStringV2 tail__1AjSMV084MnUUHJLP6MX5A);
static N_INLINE(NIM_CHAR, X5BX5D___system_7912)(NimStringV2 s__PGsSrP2Hp9bHlVetHpoUPug, NI i__MpPA5N1VsAzqiuzycRdOAg);
static N_INLINE(NIM_CHAR*, X5BX5D___system_7958)(NimStringV2* s__PGsSrP2Hp9bHlVetHpoUPug, NI i__MpPA5N1VsAzqiuzycRdOAg);
static N_INLINE(void, nimPrepareStrMutationV2)(NimStringV2* s__loo5Z73wZsb5OCeQPiUDYg);
N_LIB_PRIVATE N_NIMCALL(void, nimPrepareStrMutationImpl__system_2401)(NimStringV2* s__9azXNueo9acOrj8WVyZabYtg);
N_LIB_PRIVATE N_NIMCALL(void, normalizePathEnd__stdZprivateZospaths50_20)(NimStringV2* path__h0rZjQ0Io0U5qu5CwxuzRA, NIM_BOOL trailingSep__T4gOIp4NVp87ajbqE9bKzwA);
N_LIB_PRIVATE N_NIMCALL(void, setLengthStrV2)(NimStringV2* s__19atMbr42TbRkrQSPFxaPZg, NI newLen__zdmruIpEqwmFKxid9btfbJw);
static N_INLINE(void, nimAddCharV1)(NimStringV2* s__S65jkNxJ72wMzHX9bQ0it8w, NIM_CHAR c__q53woDK9bF1K5bAKmsVpSkA);
N_LIB_PRIVATE N_NIMCALL(void, prepareAdd)(NimStringV2* s__qL2AkrAohOvo9bZZC15G6TA, NI addlen__uGPPC8Yor9a9avOoki7IG3AQ);
N_LIB_PRIVATE N_NIMCALL(void, addNormalizePath__pureZpathnorm_83)(NimStringV2 x__HhJ3EvK0Pc3JWVNbj9boH1A, NimStringV2* result__rUHqnSyl9c0bChyYf3nrLkQ, NI* state__9akIe1B9c51IR7mLz7KH5tOg, NIM_CHAR dirSep__aJuBHLSW4AuR0lm9a4Cybtg);
static const struct {
  NI cap; NIM_CHAR data[1+1];
} TM__O1zDbSYyG8zQytyoZAh0dg_2 = { 1 | NIM_STRLIT_FLAG, "/" };
static const NimStringV2 TM__O1zDbSYyG8zQytyoZAh0dg_3 = {1, (NimStrPayload*)&TM__O1zDbSYyG8zQytyoZAh0dg_2};
extern NIM_THREADVAR NIM_BOOL nimInErrorMode__system_4297;
static N_INLINE(void, nimSetMem__systemZmemory_7)(void* a__tZiCJHYy5dYyAh9cxwrrVhQ, int v__iM7JOvZxArJIvbhGyRZG6Q, NI size__ntsFNLS0mpvnjQFrZT7DCw) {
	void* T1_;
	T1_ = (void*)0;
	T1_ = memset(a__tZiCJHYy5dYyAh9cxwrrVhQ, v__iM7JOvZxArJIvbhGyRZG6Q, ((size_t) (size__ntsFNLS0mpvnjQFrZT7DCw)));
}
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void) {
	NIM_BOOL* result;
	result = (NIM_BOOL*)0;
	result = (&nimInErrorMode__system_4297);
	return result;
}
static N_INLINE(void, nimZeroMem)(void* p__BuPKoq7dppy2upaj3KUaxw, NI size__ttWVm79bajRU3tarcA7MkLw) {
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	nimSetMem__systemZmemory_7(p__BuPKoq7dppy2upaj3KUaxw, ((int)0), size__ttWVm79bajRU3tarcA7MkLw);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
}
N_LIB_PRIVATE N_NIMCALL(void, nossplitFile)(NimStringV2 path__mQs5USj7cYSjfdcRv9cqi0A, tyTuple__7q7q3E6Oj24ZNVJb9aonhAg* Result) {
	NI namePos;
	NI dotPos;
	nimZeroMem((void*)Result, sizeof(tyTuple__7q7q3E6Oj24ZNVJb9aonhAg));
	namePos = ((NI)0);
	dotPos = ((NI)0);
	{
		NI i;
		NI colontmp_;
		NI res;
		i = (NI)0;
		colontmp_ = (NI)0;
		colontmp_ = (NI)(path__mQs5USj7cYSjfdcRv9cqi0A.len - ((NI)1));
		res = colontmp_;
		{
			while (1) {
				if (!(((NI)0) <= res)) goto LA3				;
				i = res;
				{
					NIM_BOOL T6_;
					T6_ = (NIM_BOOL)0;
					T6_ = (((NU8)(path__mQs5USj7cYSjfdcRv9cqi0A.p->data[i])) == ((NU8)(47)) || ((NU8)(path__mQs5USj7cYSjfdcRv9cqi0A.p->data[i])) == ((NU8)(47)));
					if (T6_) goto LA7_;
					T6_ = (i == ((NI)0));
					LA7_: ;
					if (!T6_) goto LA8_;
					{
						NI colontmpD_;
						NI colontmpD__2;
						NI T14_;
						NimStringV2 T21_;
						if (!(((NU8)(path__mQs5USj7cYSjfdcRv9cqi0A.p->data[i])) == ((NU8)(47)) || ((NU8)(path__mQs5USj7cYSjfdcRv9cqi0A.p->data[i])) == ((NU8)(47)))) goto LA12_;
						colontmpD_ = (NI)0;
						colontmpD__2 = (NI)0;
						T14_ = (NI)0;
						{
							NIM_BOOL T17_;
							T17_ = (NIM_BOOL)0;
							T17_ = NIM_LIKELY((((NI)1) <= i));
							if (!T17_) goto LA18_;
							colontmpD_ = (NI)(i - ((NI)1));
							T14_ = colontmpD_;
						}
						goto LA15_;
						LA18_: ;
						{
							colontmpD__2 = ((NI)0);
							T14_ = colontmpD__2;
						}
						LA15_: ;
						T21_.len = 0; T21_.p = NIM_NIL;
						T21_ = substr__system_8447(path__mQs5USj7cYSjfdcRv9cqi0A, ((NI)0), T14_);
						eqsink___stdZassertions_36((&(*Result).Field0), T21_);
						namePos = (NI)(i + ((NI)1));
					}
					LA12_: ;
					{
						NimStringV2 T26_;
						NimStringV2 T27_;
						if (!(i < dotPos)) goto LA24_;
						T26_.len = 0; T26_.p = NIM_NIL;
						T26_ = substr__system_8447(path__mQs5USj7cYSjfdcRv9cqi0A, namePos, (NI)(dotPos - ((NI)1)));
						eqsink___stdZassertions_36((&(*Result).Field1), T26_);
						T27_.len = 0; T27_.p = NIM_NIL;
						T27_ = substr__system_8459(path__mQs5USj7cYSjfdcRv9cqi0A, dotPos);
						eqsink___stdZassertions_36((&(*Result).Field2), T27_);
					}
					goto LA22_;
					LA24_: ;
					{
						NimStringV2 T29_;
						T29_.len = 0; T29_.p = NIM_NIL;
						T29_ = substr__system_8459(path__mQs5USj7cYSjfdcRv9cqi0A, namePos);
						eqsink___stdZassertions_36((&(*Result).Field1), T29_);
					}
					LA22_: ;
					goto LA1;
				}
				goto LA4_;
				LA8_: ;
				{
					NIM_BOOL T31_;
					NIM_BOOL T32_;
					NIM_BOOL T33_;
					NIM_BOOL T34_;
					NIM_BOOL T35_;
					T31_ = (NIM_BOOL)0;
					T32_ = (NIM_BOOL)0;
					T33_ = (NIM_BOOL)0;
					T34_ = (NIM_BOOL)0;
					T35_ = (NIM_BOOL)0;
					T35_ = ((NU8)(path__mQs5USj7cYSjfdcRv9cqi0A.p->data[i]) == (NU8)(46));
					if (!(T35_)) goto LA36_;
					T35_ = (((NI)0) < i);
					LA36_: ;
					T34_ = T35_;
					if (!(T34_)) goto LA37_;
					T34_ = (i < (NI)(path__mQs5USj7cYSjfdcRv9cqi0A.len - ((NI)1)));
					LA37_: ;
					T33_ = T34_;
					if (!(T33_)) goto LA38_;
					T33_ = !((((NU8)(path__mQs5USj7cYSjfdcRv9cqi0A.p->data[(NI)(i - ((NI)1))])) == ((NU8)(47)) || ((NU8)(path__mQs5USj7cYSjfdcRv9cqi0A.p->data[(NI)(i - ((NI)1))])) == ((NU8)(47))));
					LA38_: ;
					T32_ = T33_;
					if (!(T32_)) goto LA39_;
					T32_ = !(((NU8)(path__mQs5USj7cYSjfdcRv9cqi0A.p->data[(NI)(i + ((NI)1))]) == (NU8)(46)));
					LA39_: ;
					T31_ = T32_;
					if (!(T31_)) goto LA40_;
					T31_ = (dotPos == ((NI)0));
					LA40_: ;
					if (!T31_) goto LA41_;
					dotPos = i;
				}
				goto LA4_;
				LA41_: ;
				LA4_: ;
				res -= ((NI)1);
			} LA3: ;
		}
	} LA1: ;
}
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___pureZos_166)(tyTuple__7q7q3E6Oj24ZNVJb9aonhAg* dest__Rr8g9a25knUUjaET9bMhNAoQ) {
	eqdestroy___stdZassertions_30((&(*dest__Rr8g9a25knUUjaET9bMhNAoQ).Field0));
	eqdestroy___stdZassertions_30((&(*dest__Rr8g9a25knUUjaET9bMhNAoQ).Field1));
	eqdestroy___stdZassertions_30((&(*dest__Rr8g9a25knUUjaET9bMhNAoQ).Field2));
}
static N_INLINE(NIM_CHAR, X5BX5D___system_7912)(NimStringV2 s__PGsSrP2Hp9bHlVetHpoUPug, NI i__MpPA5N1VsAzqiuzycRdOAg) {
	NIM_CHAR result;
	result = (NIM_CHAR)0;
	result = s__PGsSrP2Hp9bHlVetHpoUPug.p->data[(NI)(s__PGsSrP2Hp9bHlVetHpoUPug.len - i__MpPA5N1VsAzqiuzycRdOAg)];
	return result;
}
static N_INLINE(void, nimPrepareStrMutationV2)(NimStringV2* s__loo5Z73wZsb5OCeQPiUDYg) {
	{
		NIM_BOOL T3_;
		T3_ = (NIM_BOOL)0;
		T3_ = !(((*s__loo5Z73wZsb5OCeQPiUDYg).p == ((NimStrPayload*) NIM_NIL)));
		if (!(T3_)) goto LA4_;
		T3_ = ((NI)((*(*s__loo5Z73wZsb5OCeQPiUDYg).p).cap & ((NI)IL64(4611686018427387904))) == ((NI)IL64(4611686018427387904)));
		LA4_: ;
		if (!T3_) goto LA5_;
		nimPrepareStrMutationImpl__system_2401(s__loo5Z73wZsb5OCeQPiUDYg);
	}
	LA5_: ;
}
static N_INLINE(NIM_CHAR*, X5BX5D___system_7958)(NimStringV2* s__PGsSrP2Hp9bHlVetHpoUPug, NI i__MpPA5N1VsAzqiuzycRdOAg) {
	NIM_CHAR* result;
	result = (NIM_CHAR*)0;
	nimPrepareStrMutationV2((&(*s__PGsSrP2Hp9bHlVetHpoUPug)));
	result = (&(*s__PGsSrP2Hp9bHlVetHpoUPug).p->data[(NI)((*s__PGsSrP2Hp9bHlVetHpoUPug).len - i__MpPA5N1VsAzqiuzycRdOAg)]);
	return result;
}
static N_INLINE(void, nimAddCharV1)(NimStringV2* s__S65jkNxJ72wMzHX9bQ0it8w, NIM_CHAR c__q53woDK9bF1K5bAKmsVpSkA) {
	prepareAdd(s__S65jkNxJ72wMzHX9bQ0it8w, ((NI)1));
	(*(*s__S65jkNxJ72wMzHX9bQ0it8w).p).data[(*s__S65jkNxJ72wMzHX9bQ0it8w).len] = c__q53woDK9bF1K5bAKmsVpSkA;
	(*(*s__S65jkNxJ72wMzHX9bQ0it8w).p).data[(NI)((*s__S65jkNxJ72wMzHX9bQ0it8w).len + ((NI)1))] = 0;
	(*s__S65jkNxJ72wMzHX9bQ0it8w).len += ((NI)1);
}
N_LIB_PRIVATE N_NIMCALL(void, normalizePathEnd__stdZprivateZospaths50_20)(NimStringV2* path__h0rZjQ0Io0U5qu5CwxuzRA, NIM_BOOL trailingSep__T4gOIp4NVp87ajbqE9bKzwA) {
	NI i;
{	{
		if (!((*path__h0rZjQ0Io0U5qu5CwxuzRA).len == ((NI)0))) goto LA3_;
		goto BeforeRet_;
	}
	LA3_: ;
	i = (*path__h0rZjQ0Io0U5qu5CwxuzRA).len;
	{
		while (1) {
			if (!(((NI)1) <= i)) goto LA6			;
			{
				if (!(((NU8)((*path__h0rZjQ0Io0U5qu5CwxuzRA).p->data[(NI)(i - ((NI)1))])) == ((NU8)(47)) || ((NU8)((*path__h0rZjQ0Io0U5qu5CwxuzRA).p->data[(NI)(i - ((NI)1))])) == ((NU8)(47)))) goto LA9_;
				i -= ((NI)1);
			}
			goto LA7_;
			LA9_: ;
			{
				NIM_BOOL T12_;
				NIM_BOOL T13_;
				T12_ = (NIM_BOOL)0;
				T13_ = (NIM_BOOL)0;
				T13_ = ((NU8)((*path__h0rZjQ0Io0U5qu5CwxuzRA).p->data[(NI)(i - ((NI)1))]) == (NU8)(46));
				if (!(T13_)) goto LA14_;
				T13_ = (((NI)2) <= i);
				LA14_: ;
				T12_ = T13_;
				if (!(T12_)) goto LA15_;
				T12_ = (((NU8)((*path__h0rZjQ0Io0U5qu5CwxuzRA).p->data[(NI)(i - ((NI)2))])) == ((NU8)(47)) || ((NU8)((*path__h0rZjQ0Io0U5qu5CwxuzRA).p->data[(NI)(i - ((NI)2))])) == ((NU8)(47)));
				LA15_: ;
				if (!T12_) goto LA16_;
				i -= ((NI)1);
			}
			goto LA7_;
			LA16_: ;
			{
				goto LA5;
			}
			LA7_: ;
		} LA6: ;
	} LA5: ;
	{
		if (!trailingSep__T4gOIp4NVp87ajbqE9bKzwA) goto LA21_;
		setLengthStrV2((&(*path__h0rZjQ0Io0U5qu5CwxuzRA)), ((NI) (i)));
		nimAddCharV1((&(*path__h0rZjQ0Io0U5qu5CwxuzRA)), 47);
	}
	goto LA19_;
	LA21_: ;
	{
		if (!(((NI)0) < i)) goto LA24_;
		setLengthStrV2((&(*path__h0rZjQ0Io0U5qu5CwxuzRA)), ((NI) (i)));
	}
	goto LA19_;
	LA24_: ;
	{
		eqsink___stdZassertions_36((&(*path__h0rZjQ0Io0U5qu5CwxuzRA)), TM__O1zDbSYyG8zQytyoZAh0dg_3);
	}
	LA19_: ;
	}BeforeRet_: ;
}
N_LIB_PRIVATE N_NIMCALL(void, joinPathImpl__stdZprivateZospaths50_49)(NimStringV2* result__Duce9bPtdY9cuV41HJK3P9bJQ, NI* state__RtRLRCJcio8EY23SUmqb0Q, NimStringV2 tail__1AjSMV084MnUUHJLP6MX5A) {
	NIM_BOOL trailingSep;
	NIM_BOOL T1_;
	NIM_BOOL T2_;
	NIM_CHAR T4_;
	NIM_BOOL T6_;
	NIM_BOOL T8_;
	NIM_CHAR* T10_;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	T1_ = (NIM_BOOL)0;
	T2_ = (NIM_BOOL)0;
	T2_ = (((NI)0) < tail__1AjSMV084MnUUHJLP6MX5A.len);
	if (!(T2_)) goto LA3_;
	T4_ = (NIM_CHAR)0;
	T4_ = X5BX5D___system_7912(tail__1AjSMV084MnUUHJLP6MX5A, ((NI)1));
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	T2_ = (((NU8)(T4_)) == ((NU8)(47)) || ((NU8)(T4_)) == ((NU8)(47)));
	LA3_: ;
	T1_ = T2_;
	if (T1_) goto LA5_;
	T6_ = (NIM_BOOL)0;
	T6_ = (tail__1AjSMV084MnUUHJLP6MX5A.len == ((NI)0));
	if (!(T6_)) goto LA7_;
	T8_ = (NIM_BOOL)0;
	T8_ = (((NI)0) < (*result__Duce9bPtdY9cuV41HJK3P9bJQ).len);
	if (!(T8_)) goto LA9_;
	T10_ = (NIM_CHAR*)0;
	T10_ = X5BX5D___system_7958(result__Duce9bPtdY9cuV41HJK3P9bJQ, ((NI)1));
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	T8_ = (((NU8)((*T10_))) == ((NU8)(47)) || ((NU8)((*T10_))) == ((NU8)(47)));
	LA9_: ;
	T6_ = T8_;
	LA7_: ;
	T1_ = T6_;
	LA5_: ;
	trailingSep = T1_;
	normalizePathEnd__stdZprivateZospaths50_20(result__Duce9bPtdY9cuV41HJK3P9bJQ, NIM_FALSE);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	addNormalizePath__pureZpathnorm_83(tail__1AjSMV084MnUUHJLP6MX5A, result__Duce9bPtdY9cuV41HJK3P9bJQ, state__RtRLRCJcio8EY23SUmqb0Q, 47);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	normalizePathEnd__stdZprivateZospaths50_20(result__Duce9bPtdY9cuV41HJK3P9bJQ, trailingSep);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
}
N_LIB_PRIVATE N_NIMCALL(NimStringV2, nosjoinPath)(NimStringV2 head__Mx40DJR9aVM6e620L3vO02w, NimStringV2 tail__U7e1stLgM1XkAYyz3xSB4A) {
	NimStringV2 result;
	NI state;
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	result.len = 0; result.p = NIM_NIL;
	result = rawNewString(((NI) ((NI)(head__Mx40DJR9aVM6e620L3vO02w.len + tail__U7e1stLgM1XkAYyz3xSB4A.len))));
	state = ((NI)0);
	joinPathImpl__stdZprivateZospaths50_49((&result), (&state), head__Mx40DJR9aVM6e620L3vO02w);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	joinPathImpl__stdZprivateZospaths50_49((&result), (&state), tail__U7e1stLgM1XkAYyz3xSB4A);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
	return result;
}
